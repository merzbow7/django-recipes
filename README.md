# Сборник рецептов

Сборник рецептов.

## Установка

```bash
git clone https://github.com/merzbow7/django-recipes.git
```

```bash
cd django-recipes
```

## Использование Docker

### Настройка проекта

Создайте `.env` файл в корне репозитория:

```bash
cp .env.dist .env
```
Внесите при необходимости корректировки в переменные окружения.

### Сборка образов и запуск контейнеров

Если локально запущен postgres, остановите его:

```bash
sudo systemctl stop postgresql
```

В корне репозитория выполните команду:

```bash
docker-compose up --build
```

При первом запуске данный процесс может занять несколько минут.

Проект доступен по адресу http://127.0.0.1:8000

Данные для доступа к панели администратора указываются в .env файле.


### bash скрипты в проекте

проект содержит два bash-скрипта:
- run.sh - обеспечивает инициализацию и выполняется автоматически при старте контейнера.
  * `poetry install --no-dev` - установка пакетов без зависимостей для разработки.
  * `poetry run python manage.py mograte` - применение миграций.
  * `poetry run python manage.py loaddata ingredient ingredientunit recipeingredient recipe` - загрузка заранее сохранённых фикстур.
  * `poetry run python manage.py initadmin` - создание суперпользователя из переменных окружения, исходный код команды в recipes/management/commands/initadmin.py 
  * `poetry run python manage.py runserver 0.0.0.0:8000` - запуск сервера.
  
- fixture.sh - служит для создания фикстур.
    * создаёт из текущей базы фикстуры для приложения recipes и сохраняет их в катологе приложения recipes/fixtures.

Команды так же можно выполнить внутри контейнера приложения:

```bash
docker-compose exec app bash
```
И вводим вышеупомянутые команды или bash-скрипты.
Так же могут пригодится дополнительные команды:
*  `poetry run python flush --no-input` - Очищает БД.
*  `poetry run python makemigrations` - Создаёт миграции.

### Работа с админкой Django

Список ингредиентов для рецептов вставляется в соответсвуюшее поле, каждый ингредиент должен содержать название, через
двоеточие количество и через подчёркивание единицы измерения.
Например:
- Лук: 3_шт.
- Масло растительно : 100_г.
- Соль : по вкусу